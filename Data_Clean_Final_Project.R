library(tidyverse)
library(dplyr)
library(magrittr)

##Subway data select and clean#####################################################
##import MBTA data
HR_Q1_2022 <- read.csv("~/Desktop/TravelTimes_2022/2022-Q1_HRTravelTimes.csv")
LR_Q1_2022 <- read.csv("~/Desktop/TravelTimes_2022/2022-Q1_LRTravelTimes.csv")
HR_Q2_2022 <- read.csv("~/Desktop/TravelTimes_2022/2022-Q2_HRTravelTimes.csv")
LR_Q2_2022 <- read.csv("~/Desktop/TravelTimes_2022/2022-Q2_LRTravelTimes.csv")
HR_Q3_2022 <- read.csv("~/Desktop/TravelTimes_2022/2022-Q3_HRTravelTimes.csv")
LR_Q3_2022 <- read.csv("~/Desktop/TravelTimes_2022/2022-Q3_lRTravelTimes.csv")
HR_Q4_2021 <- read.csv("~/Desktop/Travel_Times_2021/HRTravelTimesQ4_21.csv")
LR_Q4_2021 <- read.csv("~/Desktop/Travel_Times_2021/LRTravelTimesQ4_21.csv")

##selected data
HR_W1 <- HR_Q4_2021 %>% 
  filter(service_date == c("2021-10-04","2021-10-05","2021-10-06","2021-10-07",
                           "2021-10-08","2021-10-09","2021-10-10"))
LR_W1 <- LR_Q4_2021 %>% 
  filter(service_date == c("2021-10-04","2021-10-05","2021-10-06","2021-10-07",
                           "2021-10-08","2021-10-09","2021-10-10"))

HR_W2 <- HR_Q4_2021 %>% 
  filter(service_date == c("2021-11-01","2021-11-02","2021-11-03","2021-11-04",
                           "2021-11-05","2021-11-06","2021-11-07"))
LR_W2 <- LR_Q4_2021 %>% 
  filter(service_date == c("2021-11-01","2021-11-02","2021-11-03","2021-11-04",
                           "2021-11-05","2021-11-06","2021-11-07"))

HR_W3 <- HR_Q4_2021 %>% 
  filter(service_date == c("2021-12-06","2021-12-07","2021-12-08","2021-12-09",
                           "2021-12-10","2021-12-11","2021-12-12"))
LR_W3 <- LR_Q4_2021 %>% 
  filter(service_date == c("2021-12-06","2021-12-07","2021-12-08","2021-12-09",
                           "2021-12-10","2021-12-11","2021-12-12"))

HR_W4 <- HR_Q1_2022 %>% 
  filter(service_date == c("2022-01-03","2022-01-04","2022-01-05","2022-01-06",
                           "2022-01-07","2022-01-08","2022-01-09"))
LR_W4 <- LR_Q1_2022 %>% 
  filter(service_date == c("2022-01-03","2022-01-04","2022-01-05","2022-01-06",
                           "2022-01-07","2022-01-08","2022-01-09"))

HR_W5 <- HR_Q1_2022 %>% 
  filter(service_date == c("2022-02-07","2022-02-08","2022-02-09","2022-02-10",
                           "2022-02-11","2022-02-12","2022-02-13"))
LR_W5 <- LR_Q1_2022 %>% 
  filter(service_date == c("2022-02-07","2022-02-08","2022-02-09","2022-02-10",
                           "2022-02-11","2022-02-12","2022-02-13"))

HR_W6 <- HR_Q1_2022 %>% 
  filter(service_date == c("2022-03-07","2022-03-08","2022-03-09","2022-03-10",
                           "2022-03-11","2022-03-12","2022-03-13"))
LR_W6 <- LR_Q1_2022 %>% 
  filter(service_date == c("2022-03-07","2022-03-08","2022-03-09","2022-03-10",
                           "2022-03-11","2022-03-12","2022-03-13"))

HR_W7 <- HR_Q2_2022 %>% 
  filter(service_date == c("2022-04-04","2022-04-05","2022-04-06","2022-04-07",
                           "2022-04-08","2022-04-09","2022-04-10"))
LR_W7 <- LR_Q2_2022 %>% 
  filter(service_date == c("2022-04-04","2022-04-05","2022-04-06","2022-04-07",
                           "2022-04-08","2022-04-09","2022-04-10"))

HR_W8 <- HR_Q2_2022 %>% 
  filter(service_date == c("2022-05-02","2022-05-03","2022-05-04","2022-05-05",
                           "2022-05-06","2022-05-07","2022-05-08"))
LR_W8 <- LR_Q2_2022 %>% 
  filter(service_date == c("2022-05-02","2022-05-03","2022-05-04","2022-05-05",
                           "2022-05-06","2022-05-07","2022-05-08"))

HR_W9 <- HR_Q2_2022 %>% 
  filter(service_date == c("2022-06-05","2022-06-06","2022-06-07","2022-06-08",
                           "2022-06-09","2022-06-10","2022-06-11"))
LR_W9 <- LR_Q2_2022 %>% 
  filter(service_date == c("2022-06-05","2022-06-06","2022-06-07","2022-06-08",
                           "2022-06-09","2022-06-10","2022-06-11"))

HR_W10 <- HR_Q3_2022 %>% 
  filter(service_date == c("2022-07-03","2022-07-04","2022-07-05","2022-07-06",
                           "2022-07-07","2022-07-08","2022-07-09"))
LR_W10 <- LR_Q3_2022 %>% 
  filter(service_date == c("2022-07-03","2022-07-04","2022-07-05","2022-07-06",
                           "2022-07-07","2022-07-08","2022-07-09"))

HR_W11 <- HR_Q3_2022 %>% 
  filter(service_date == c("2022-08-07","2022-08-08","2022-08-09","2022-08-10",
                           "2022-08-11","2022-08-12","2022-08-13"))
LR_W11 <- LR_Q3_2022 %>% 
  filter(service_date == c("2022-08-07","2022-08-08","2022-08-09","2022-08-10",
                           "2022-08-11","2022-08-12","2022-08-13"))

HR_W12 <- HR_Q3_2022 %>% 
  filter(service_date == c("2022-09-05","2022-09-06","2022-09-07","2022-09-08",
                           "2022-09-09","2022-09-10","2022-09-11"))
LR_W12 <- LR_Q3_2022 %>% 
  filter(service_date == c("2022-09-05","2022-09-06","2022-09-07","2022-09-08",
                           "2022-09-09","2022-09-10","2022-09-11"))
##Build data
HR_selected <-bind_rows(HR_W1,HR_W2,HR_W3,HR_W4,HR_W5,HR_W5,HR_W6,HR_W7,HR_W8,
                        HR_W9,HR_W10,HR_W11,HR_W12)
LR_selected <-bind_rows(LR_W1,LR_W2,LR_W3,LR_W4,LR_W5,LR_W5,LR_W6,LR_W7,LR_W8,
                        LR_W9,LR_W10,LR_W11,LR_W12)

##Clean data
##find na
HR_NA <- which(is.na(HR_selected))
LR_NA <- which(is.na(LR_selected))
##delete the colnames only have one value
HR_selected%<>% separate(col = service_date, into = c("year","month","day"),sep = "-")
LR_selected%<>% separate(col = service_date, into = c("year","month","day"),sep = "-")
HR_selected$service_date<-paste(HR_selected$year,HR_selected$month,HR_selected$day,sep = "-")
LR_selected$service_date<-paste(LR_selected$year,LR_selected$month,LR_selected$day,sep = "-")

HR_selected%<>%mutate(week=case_when(service_date %in% c("2021-10-04","2021-11-01",
                                               "2021-12-06","2022-01-03",
                                               "2022-02-07","2022-03-07",
                                               "2022-04-04","2022-05-02",
                                               "2022-06-05","2022-07-03",
                                               "2022-08-07","2022-09-05")~"Monday",
                           service_date %in% c("2021-10-05","2021-11-02",
                                               "2021-12-07","2022-01-04",
                                               "2022-02-08","2022-03-08",
                                               "2022-04-05","2022-05-03",
                                               "2022-06-06","2022-07-04",
                                               "2022-08-08","2022-09-06")~"Tuesday",
                           service_date %in% c("2021-10-06","2021-11-03",
                                               "2021-12-08","2022-01-05",
                                               "2022-02-09","2022-03-09",
                                               "2022-04-06","2022-05-04",
                                               "2022-06-07","2022-07-05",
                                               "2022-08-09","2022-09-07")~"Wednesday",
                           service_date %in% c("2021-10-07","2021-11-04",
                                               "2021-12-09","2022-01-06",
                                               "2022-02-10","2022-03-10",
                                               "2022-04-07","2022-05-05",
                                               "2022-06-08","2022-07-06",
                                               "2022-08-10","2022-09-08")~"Thursday",
                           service_date %in% c("2021-10-08","2021-11-05",
                                               "2021-12-10","2022-01-07",
                                               "2022-02-11","2022-03-11",
                                               "2022-04-08","2022-05-06",
                                               "2022-06-09","2022-07-07",
                                               "2022-08-11","2022-09-09")~"Friday",
                           service_date %in% c("2021-10-09","2021-11-06",
                                               "2021-12-11","2022-01-08",
                                               "2022-02-12","2022-03-12",
                                               "2022-04-09","2022-05-07",
                                               "2022-06-10","2022-07-08",
                                               "2022-08-12","2022-09-10")~"Saturday",
                           service_date %in% c("2021-10-10","2021-11-07",
                                               "2021-12-12","2022-01-09",
                                               "2022-02-13","2022-03-13",
                                               "2022-04-10","2022-05-08",
                                               "2022-06-11","2022-07-09",
                                               "2022-08-13","2022-09-11")~"Sunday",
                           ))

LR_selected%<>%mutate(week=case_when(service_date %in% c("2021-10-04","2021-11-01",
                                                         "2021-12-06","2022-01-03",
                                                         "2022-02-07","2022-03-07",
                                                         "2022-04-04","2022-05-02",
                                                         "2022-06-05","2022-07-03",
                                                         "2022-08-07","2022-09-05")~"Monday",
                                     service_date %in% c("2021-10-05","2021-11-02",
                                                         "2021-12-07","2022-01-04",
                                                         "2022-02-08","2022-03-08",
                                                         "2022-04-05","2022-05-03",
                                                         "2022-06-06","2022-07-04",
                                                         "2022-08-08","2022-09-06")~"Tuesday",
                                     service_date %in% c("2021-10-06","2021-11-03",
                                                         "2021-12-08","2022-01-05",
                                                         "2022-02-09","2022-03-09",
                                                         "2022-04-06","2022-05-04",
                                                         "2022-06-07","2022-07-05",
                                                         "2022-08-09","2022-09-07")~"Wednesday",
                                     service_date %in% c("2021-10-07","2021-11-04",
                                                         "2021-12-09","2022-01-06",
                                                         "2022-02-10","2022-03-10",
                                                         "2022-04-07","2022-05-05",
                                                         "2022-06-08","2022-07-06",
                                                         "2022-08-10","2022-09-08")~"Thursday",
                                     service_date %in% c("2021-10-08","2021-11-05",
                                                         "2021-12-10","2022-01-07",
                                                         "2022-02-11","2022-03-11",
                                                         "2022-04-08","2022-05-06",
                                                         "2022-06-09","2022-07-07",
                                                         "2022-08-11","2022-09-09")~"Friday",
                                     service_date %in% c("2021-10-09","2021-11-06",
                                                         "2021-12-11","2022-01-08",
                                                         "2022-02-12","2022-03-12",
                                                         "2022-04-09","2022-05-07",
                                                         "2022-06-10","2022-07-08",
                                                         "2022-08-12","2022-09-10")~"Saturday",
                                     service_date %in% c("2021-10-10","2021-11-07",
                                                         "2021-12-12","2022-01-09",
                                                         "2022-02-13","2022-03-13",
                                                         "2022-04-10","2022-05-08",
                                                         "2022-06-11","2022-07-09",
                                                         "2022-08-13","2022-09-11")~"Sunday",
))



##export data
write.csv(HR_selected,"~/Desktop/HR_selected.csv")
write.csv(LR_selected,"~/Desktop/LR_selected.csv")


######BUS data selected and Build##############################################
Bus_10_21 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2021/MBTA-Bus-Arrival-Departure-Times_2021-10.csv")
Bus_11_21 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2021/MBTA-Bus-Arrival-Departure-Times_2021-11.csv")
Bus_12_21 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2021/MBTA-Bus-Arrival-Departure-Times_2021-12.csv")
Bus_01_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-01.csv")
Bus_02_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-02.csv")
Bus_03_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-03.csv")
Bus_04_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-04.csv")
Bus_05_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-05.csv")
Bus_06_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-06.csv")
Bus_07_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-07.csv")
Bus_08_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-08.csv")
Bus_09_22 <- read.csv("~/Desktop/MBTA_Bus_Arrival_Departure_Times_2022/MBTA-Bus-Arrival-Departure-Times_2022-09.csv")
##selected data
Bus_W1 <- Bus_10_21 %>% 
  filter(service_date == c("2021-10-04","2021-10-05","2021-10-06","2021-10-07",
                           "2021-10-08","2021-10-09","2021-10-10"))
Bus_W2 <- Bus_11_21 %>% 
  filter(service_date == c("2021-11-01","2021-11-02","2021-11-03","2021-11-04",
                           "2021-11-05","2021-11-06","2021-11-07"))
Bus_W3 <- Bus_12_21 %>% 
  filter(service_date == c("2021-12-06","2021-12-07","2021-12-08","2021-12-09",
                           "2021-12-10","2021-12-11","2021-12-12"))
Bus_W4 <- Bus_01_22 %>% 
  filter(service_date == c("2022-01-03","2022-01-04","2022-01-05","2022-01-06",
                           "2022-01-07","2022-01-08","2022-01-09"))
Bus_W5 <- Bus_02_22 %>% 
  filter(service_date == c("2022-02-07","2022-02-08","2022-02-09","2022-02-10",
                           "2022-02-11","2022-02-12","2022-02-13"))

Bus_W6 <- Bus_03_22 %>% 
  filter(service_date == c("2022-03-07","2022-03-08","2022-03-09","2022-03-10",
                           "2022-03-11","2022-03-12","2022-03-13"))
Bus_W7 <- Bus_04_22 %>% 
  filter(service_date == c("2022-04-04","2022-04-05","2022-04-06","2022-04-07",
                           "2022-04-08","2022-04-09","2022-04-10"))

Bus_W8 <- Bus_05_22 %>% 
  filter(service_date == c("2022-05-02","2022-05-03","2022-05-04","2022-05-05",
                           "2022-05-06","2022-05-07","2022-05-08"))

Bus_W9 <- Bus_06_22 %>% 
  filter(service_date == c("2022-06-05","2022-06-06","2022-06-07","2022-06-08",
                           "2022-06-09","2022-06-10","2022-06-11"))
Bus_W10 <- Bus_07_22 %>% 
  filter(service_date == c("2022-07-03","2022-07-04","2022-07-05","2022-07-06",
                           "2022-07-07","2022-07-08","2022-07-09"))

Bus_W11 <- Bus_08_22 %>% 
  filter(service_date == c("2022-08-07","2022-08-08","2022-08-09","2022-08-10",
                           "2022-08-11","2022-08-12","2022-08-13"))

Bus_W12 <- Bus_09_22 %>% 
  filter(service_date == c("2022-09-05","2022-09-06","2022-09-07","2022-09-08",
                           "2022-09-09","2022-09-10","2022-09-11"))

##build data
BUS_selected <-bind_rows(Bus_W1,Bus_W2,Bus_W3,Bus_W4,Bus_W5,Bus_W6,Bus_W7,Bus_W8,
                         Bus_W9,Bus_W10,Bus_W11,Bus_W12)

BUS_selected%<>%mutate(week=case_when(service_date %in% c("2021-10-04","2021-11-01",
                                                         "2021-12-06","2022-01-03",
                                                         "2022-02-07","2022-03-07",
                                                         "2022-04-04","2022-05-02",
                                                         "2022-06-05","2022-07-03",
                                                         "2022-08-07","2022-09-05")~"Monday",
                                     service_date %in% c("2021-10-05","2021-11-02",
                                                         "2021-12-07","2022-01-04",
                                                         "2022-02-08","2022-03-08",
                                                         "2022-04-05","2022-05-03",
                                                         "2022-06-06","2022-07-04",
                                                         "2022-08-08","2022-09-06")~"Tuesday",
                                     service_date %in% c("2021-10-06","2021-11-03",
                                                         "2021-12-08","2022-01-05",
                                                         "2022-02-09","2022-03-09",
                                                         "2022-04-06","2022-05-04",
                                                         "2022-06-07","2022-07-05",
                                                         "2022-08-09","2022-09-07")~"Wednesday",
                                     service_date %in% c("2021-10-07","2021-11-04",
                                                         "2021-12-09","2022-01-06",
                                                         "2022-02-10","2022-03-10",
                                                         "2022-04-07","2022-05-05",
                                                         "2022-06-08","2022-07-06",
                                                         "2022-08-10","2022-09-08")~"Thursday",
                                     service_date %in% c("2021-10-08","2021-11-05",
                                                         "2021-12-10","2022-01-07",
                                                         "2022-02-11","2022-03-11",
                                                         "2022-04-08","2022-05-06",
                                                         "2022-06-09","2022-07-07",
                                                         "2022-08-11","2022-09-09")~"Friday",
                                     service_date %in% c("2021-10-09","2021-11-06",
                                                         "2021-12-11","2022-01-08",
                                                         "2022-02-12","2022-03-12",
                                                         "2022-04-09","2022-05-07",
                                                         "2022-06-10","2022-07-08",
                                                         "2022-08-12","2022-09-10")~"Saturday",
                                     service_date %in% c("2021-10-10","2021-11-07",
                                                         "2021-12-12","2022-01-09",
                                                         "2022-02-13","2022-03-13",
                                                         "2022-04-10","2022-05-08",
                                                         "2022-06-11","2022-07-09",
                                                         "2022-08-13","2022-09-11")~"Sunday",
))

##export data
write.csv(BUS_selected,"~/Desktop/BUS_selected.csv")

######Ferry data selected and Build##############################################
##Import data
Ferry<-read.csv("~/Desktop/MBTA_Ferry_Daily_Ridership_by_Trip%2C_Route%2C_and_Stop.csv")
##Select data
Ferry%<>% separate(col = service_date, into = c("service_date","time"),sep = " ")
Ferry_selected <- Ferry %>% 
  filter(service_date == c("2021/01/04","2021/01/05","2021/01/06","2021/01/07",
                           "2021/01/08","2021/01/09","2021/01/10","2021/02/01",
                           "2021/02/02","2021/02/03","2021/02/04","2021/02/05",
                           "2021/02/06","2021/02/07","2021/03/01","2021/03/02",
                           "2021/03/03","2021/03/04","2021/03/05","2021/03/06",
                           "2021/03/07","2021/04/05","2021/04/06","2021/04/07",
                           "2021/04/08","2021/04/09","2021/04/10","2021/04/11",
                           "2021/05/03","2021/05/04","2021/05/05","2021/05/06",
                           "2021/05/07","2021/05/08","2021/05/09","2021/06/07",
                           "2021/06/08","2021/06/09","2021/06/10","2021/06/11",
                           "2021/06/12","2021/06/13","2021/07/05","2021/07/06",
                           "2021/07/07","2021/07/08","2021/07/09","2021/07/10",
                           "2021/07/11","2021/08/02","2021/08/03","2021/08/04",
                           "2021/08/05","2021/08/06","2021/08/07","2021/08/08",
                           "2021/09/06","2021/09/07","2021/09/08","2021/09/09",
                           "2021/09/10","2021/09/11","2021/09/12","2021/10/04",
                           "2021/10/05","2021/10/06","2021/10/07","2021/10/08",
                           "2021/10/09","2021/10/10","2021/11/01","2021/11/02",
                           "2021/11/03","2021/11/04","2021/11/05","2021/11/06",
                           "2021/11/07","2021/12/06","2021/12/07","2021/12/08",
                           "2021/12/09","2021/12/10","2021/12/11","2021/12/12"))

Ferry_selected%<>%mutate(week=case_when(service_date %in% c("2021/01/04",
                                                            "2021/06/07",
                                                            "2021/07/05",
                                                            "2021/08/02",
                                                            "2021/09/06",
                                                            "2021/10/04",
                                                            "2021/12/06")~"Monday",
                                        service_date %in% c("2021/01/05",
                                                            "2021/02/02",
                                                            "2021/06/08",
                                                            "2021/07/06",
                                                            "2021/08/03",
                                                            "2021/09/07",
                                                            "2021/10/05",
                                                            "2021/11/02",
                                                            "2021/12/07")~"Tuesday",
                                        service_date %in% c("2021/01/06",
                                                            "2021/04/06",
                                                            "2021/05/04",
                                                            "2021/02/03",
                                                            "2021/06/09",
                                                            "2021/08/04",
                                                            "2021/09/08",
                                                            "2021/10/06",
                                                            "2021/11/03",
                                                            "2021/12/08")~"Wednesday",
                                        service_date %in% c("2021/01/07",
                                                            "2021/02/04",
                                                            "2021/05/06",
                                                            "2021/06/10",
                                                            "2021/07/08",
                                                            "2021/08/05",
                                                            "2021/09/09",
                                                            "2021/12/09")~"Thursday",
                                        service_date %in% c("2021/01/08",
                                                            "2021/02/05",
                                                            "2021/03/05",
                                                            "2021/05/07",
                                                            "2021/06/11",
                                                            "2021/07/09",
                                                            "2021/08/06",
                                                            "2021/09/10",
                                                            "2021/10/08",
                                                            "2021/11/05",
                                                            "2021/12/10")~"Friday",
                                        service_date %in% c("2021/01/04",
                                                            "2021/06/12",
                                                            "2021/07/10",
                                                            "2021/12/11")~"Saturday",
                                        service_date %in% c("2021/01/04",
                                                            "2021/06/13",
                                                            "2021/07/11",
                                                            "2021/09/12",
                                                            "2021/11/07")~"Sunday"
))

##export data
write.csv(Ferry_selected,"~/Desktop/Ferry_selected.csv")

######Shiny travel time calculate##############################################

##subway travel time
d1<-LR_selected %>%filter(route_id=="Green-B"&service_date=="2022-01-07"&from_stop_id==71151 &
                            to_stop_id==70145)%>%summarise(travel_time = mean(travel_time_sec))
d2<-HR_selected %>%filter(route_id=="Red"&service_date=="2022-04-08"&from_stop_id==70074 &
                            to_stop_id==70064)%>%summarise(travel_time = mean(travel_time_sec))
d3<-HR_selected %>%filter(route_id=="Orange"&service_date=="2022-07-03"&from_stop_id==70019 &
                            to_stop_id==70027)%>%summarise(travel_time = mean(travel_time_sec))

##bus travel time
d4<-BUS_selected %>%filter(route_id=="83"&service_date=="2022-07-04"&direction_id =="Inbound")
a<-as.POSIXct("1900-01-01 13:13:35.000")
b<-as.POSIXct("1900-01-01 15:27:02.000")
b1<-difftime(b,a)

d5<-BUS_selected %>%filter(route_id=="01"&service_date=="2021-12-09"&direction_id =="Inbound")
a<-as.POSIXct("1900-01-01 11:28:25.000")
b<-as.POSIXct("1900-01-01 12:18:00.000")
b2<-difftime(b,a)

d6<-BUS_selected %>%filter(route_id=="100"&service_date=="2022-06-07"& direction_id =="Inbound")
a<-as.POSIXct("1900-01-01 05:00:00.000")
b<-as.POSIXct("1900-01-01 06:10:00.000")
b3<-difftime(b,a)

##Ferry travel time
a<-as.POSIXct("2021-01-08 18:41:00")
b<-as.POSIXct("2021-01-08 19:14:00")
b4<-difftime(b,a)

a<-as.POSIXct("2021-08-04 09:05:00")
b<-as.POSIXct("2021-08-04 09:32:00")
b5<-difftime(b,a)

a<-as.POSIXct("2021-06-10 18:15:00")
b<-as.POSIXct("2021-06-10 18:25:00")
b6<-difftime(b,a)


